# Домашнее задание к Уроку 7: Подзапросы и их применение

## Часть 1: Основы подзапросов
### Подзапросы в FROM
```sql
-- 1. Найдите страны с количеством клиентов ≥ 3 и посчитайте общее число клиентов в этих странах
-- 2. Определите дни, когда было более 2 заказов, и выведите общее количество таких дней
-- 3. Для категории Beverages посчитайте среднюю стоимость товара
```

### Подзапросы в WHERE (IN)
```sql
-- 1. Выведите заказы, сделанные клиентами из Парижа, Берлина или Лондона
-- 2. Найдите товары, которые никогда не заказывались
-- 3. Определите сотрудников, оформивших заказы для клиентов из Испании
```

## Часть 2: CTE (Common Table Expressions)
### Использование WITH
```sql
-- 1. С помощью CTE посчитайте количество клиентов с более чем 10 заказами
-- 2. Для категории Confections рассчитайте общую выручку (округлите до целого)
-- 3. Найдите города доставки с >5 заказами в 1997 году и посчитайте количество таких городов
```

## Часть 3: Аналитические задания
### Работа с агрегацией
```sql
-- 1. Выведите категории товаров и их общую выручку, отсортировав по убыванию прибыли
-- 2. Определите сотрудника, оформившего заказ для Simon Crowther 29 апреля 1998 года
-- 3. Найдите среднее количество заказов на клиента по странам (только для стран с ≥3 клиентами)
```

### Комплексные запросы
```sql
-- 1. Посчитайте разницу между общей выручкой и выручкой от категории Beverages
-- 2. Определите клиентов, которые делали заказы в те же даты, когда было >2 заказов
-- 3. Найдите товары, цена которых выше средней цены в их категории
```

### Советы:
1. Для подзапросов в SELECT используйте коррелированные запросы
2. В CTE можно создавать несколько временных таблиц через запятую
3. Используйте HAVING для фильтрации после группировки
4. Не забывайте про псевдонимы таблиц в сложных запросах
