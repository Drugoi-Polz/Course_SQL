# Домашнее задание к Уроку 8: Условная логика с CASE

## Часть 1: Базовое использование CASE
### Замена значений NULL
```sql
-- 1. Выведите список клиентов (customer_id, contact_name, region) с заменой пустых регионов на 'undefined'
-- 2. Выведите список сотрудников (employee_id, first_name, last_name, region) с заменой пустых регионов на 'N/A'
-- 3. Для товаров в таблице products: выведите product_name, unit_price, а также новый столбец discount_status. Если скидка (discount) больше 0, то 'Discounted', иначе 'Regular'
```

### Классификация данных
```sql
-- 1. Классифицируйте страны клиентов на 'Europe', 'North America', 'South America', 'Asia', 'Other'. Выведите contact_name, country, и новый столбец continent.
-- 2. Разделите товары на ценовые категории: 'Budget' (цена < 20), 'Mid-range' (20 <= цена < 50), 'Premium' (цена >= 50). Выведите product_name, unit_price, price_category.
-- 3. Разделите заказы на категории по дате: 'Old' (до 1997 года), '1997', '1998'. Выведите order_id, order_date, order_period.
```

## Часть 2: CASE в агрегатных функциях
### Анализ категорий
```sql
-- 1. Посчитайте количество клиентов в каждом регионе (с заменой NULL на 'undefined')
-- 2. Для каждой ценовой категории товаров посчитайте среднюю цену
-- 3. Для каждого года (order_date) посчитайте общую сумму заказов, но только для заказов, которые не отменены (shipped_date не NULL)
```

## Часть 3: Комплексные задания
### Работа с несколькими таблицами
```sql
-- 1. Определите общую выручку по континентам клиентов (используйте классификацию из части 1)
-- 2. Выведите список категорий товаров (category_name) и количество товаров в каждой категории, добавьте столбец stock_status: 'High' (>=10), 'Medium' (5-9), 'Low' (<5)
-- 3. Посчитайте среднее количество товаров в заказе и классифицируйте заказы: 'Above Average' и 'Below Average'
```

### Советы:
1. Используйте CASE внутри SELECT для создания новых столбцов
2. Для агрегации с CASE можно использовать конструкцию:  
   ```sql
   SUM(CASE WHEN condition THEN 1 ELSE 0 END)
   ```
3. Помните о NULL: используйте COALESCE или условия с IS NULL
4. В сложных запросах применяйте CTE (WITH) для разбивки на логические части
